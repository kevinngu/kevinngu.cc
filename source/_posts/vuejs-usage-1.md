---
title: Vue.js 应用（1）
categories:
- Vue.js
tags:
- Vue.js
---
> 动态组件与列表渲染

<!-- more -->
记录一点点做项目的感悟

在项目中遇到一个需求，在列表中对行数据勾选后，可以在这行的前后添加新行，通常，从js或者jquery的固有思维习惯来讲，我二话没说，直接写了个行组件，然后动态加入到列表中，like this:
#### 组件与动态插入
``` javascript
//行组件的模板：
<script type='x-template' id='test'>
	some code
</script>
```
在运行逻辑的script里面：
``` javascript
//声明组件：
var test = Vue.extend({
	template: '#test',
	data():{},
	methods:{}
})

//父组件的实例
export default{
	data():{},
	methods:{
		addBefore():{
			//实例化行组件
			new test().$mount().$before(element);
		},
		addAfter():{}
	}
}
```
一看，嗯，功能实现了，的确是可以动态插入行了，写这个的当天不知道为啥，发烧，39.5度，整天头都是懵逼的状态，自然也就没多想，到了下午4点的时候，头痛得实在受不了了，果断提前下班去医院打个吊针，第二天退烧了，回来继续做这个东西，想想，好像TM不是这么回事啊。。。
#### 问题
1. 维护N份实例里面的data啊，动态创建出来的组件里面的data属性和父组件的data都是不互通的，虽然应该有办法打通（没试过），但是维护这么多数据很容易混乱的。
2. 无法精确的插入行到指定位置，因为`$before(), $appendTo(), $after()` 这些就像jquery一样，要指定element，或者id, class的，对一份一毛一样的组件模板做这些控制就会很麻烦了。
3. 因为这份列表的数据放到数据库是要有序列的，但是vue这种数据绑定的做法如果用动态加入的方式, 要再去维护数据的序列要花费更大的功夫。

问题真多，当用vue做开发要做到这么不优雅的时候，那只能证明对vue还不足够了解。

#### 列表渲染
换个角度想问题，既然vue是数据驱动开发，完全可以通过列表渲染然后动态改变数组的方式去做到`addBefore(), addAfter()` 啊：
``` javascript
//只需要简单的：
array.splice(index,0,obj);

//v-for="a in array"
```
如此，上面的三个问题就都解决了。所以以后遇到不能用优雅的手段解决问题的时候，应该要想想自己脑子是不是进水了。


----------------------我是有底线的人------------------------